<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report Details - Alert X</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="reports.css">
    <link rel="stylesheet" href="report-detail.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Leaflet for maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>
<body>
    <nav class="navbar">
        <div class="logo">Alert X</div>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="video-finder.html">Video Finder</a>
            <a href="live-finder.html">Live Finder</a>
            <a href="reports.html" class="active">Reports</a>
            <div class="profile-dropdown">
                <button class="profile-btn">
                    <img src="" alt="Profile" id="profileImage" class="profile-img">
                    <span id="profileName">User</span>
                </button>
                <div class="dropdown-content">
                    <a href="profile.html">Profile</a>
                    <a href="settings.html">Settings</a>
                    <a href="#" id="logoutBtn">Logout</a>
                </div>
            </div>
        </div>
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>

    <main class="report-detail-container">
        <div class="report-detail-header">
            <div class="back-button">
                <a href="reports.html"><i class="fas fa-arrow-left"></i> Back to Reports</a>
            </div>
            <div class="report-actions">
                <button id="downloadReportBtn" class="btn-outline"><i class="fas fa-download"></i> Download</button>
                <button id="shareReportBtn" class="btn-outline"><i class="fas fa-share-alt"></i> Share</button>
                <button id="saveReportBtn" class="btn-outline"><i class="far fa-bookmark"></i> Save</button>
            </div>
        </div>

        <div class="report-detail-content">
            <div class="report-detail-main">
                <div class="report-detail-card">
                    <div class="report-detail-header-content">
                        <div class="report-detail-title">
                            <h1 id="reportTitle">Vehicle Collision Detected</h1>
                            <div class="report-badges">
                                <span class="report-type accident" id="reportType">Accident</span>
                                <span class="report-severity high" id="reportSeverity">High</span>
                            </div>
                        </div>
                        <div class="report-detail-meta">
                            <div class="meta-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span id="reportLocation">East Sector, Junction 8</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-clock"></i>
                                <span id="reportTime">May 14, 2023 - 17:23 PM</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-video"></i>
                                <span id="reportSource">Camera ID: CAM-042</span>
                            </div>
                        </div>
                    </div>

                    <div class="report-detail-body">
                        <div class="report-summary-card">
                            <h2>AI Analysis Summary</h2>
                            <div class="ai-summary">
                                <div class="ai-avatar">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="ai-message">
                                    <p id="aiSummary">Two-vehicle collision detected at East Sector, Junction 8 at 17:23. The collision appears to involve a sedan and an SUV. Potential injuries detected based on impact severity. Emergency services have been automatically notified. Traffic congestion is building up in the area. Recommend dispatching traffic management personnel to the scene.</p>
                                </div>
                            </div>
                        </div>

                        <div class="report-media-section">
                            <h2>Video Evidence</h2>
                            <div class="video-container">
                                <video id="reportVideo" controls poster="https://via.placeholder.com/800x450?text=Video+Evidence">
                                    <source src="" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                                <div class="video-timeline">
                                    <div class="timeline-marker" style="left: 25%;" data-time="00:12">
                                        <div class="marker-tooltip">Initial Detection</div>
                                    </div>
                                    <div class="timeline-marker" style="left: 45%;" data-time="00:22">
                                        <div class="marker-tooltip">Collision Moment</div>
                                    </div>
                                    <div class="timeline-marker" style="left: 75%;" data-time="00:37">
                                        <div class="marker-tooltip">Aftermath</div>
                                    </div>
                                </div>
                            </div>
                            <div class="snapshots-container">
                                <h3>Key Snapshots</h3>
                                <div class="snapshots-grid">
                                    <div class="snapshot">
                                        <img src="https://via.placeholder.com/300x200?text=Pre-Collision" alt="Pre-Collision">
                                        <div class="snapshot-caption">
                                            <span class="snapshot-time">00:12</span>
                                            <span class="snapshot-label">Pre-Collision</span>
                                        </div>
                                    </div>
                                    <div class="snapshot">
                                        <img src="https://via.placeholder.com/300x200?text=Collision+Moment" alt="Collision Moment">
                                        <div class="snapshot-caption">
                                            <span class="snapshot-time">00:22</span>
                                            <span class="snapshot-label">Collision Moment</span>
                                        </div>
                                    </div>
                                    <div class="snapshot">
                                        <img src="https://via.placeholder.com/300x200?text=Aftermath" alt="Aftermath">
                                        <div class="snapshot-caption">
                                            <span class="snapshot-time">00:37</span>
                                            <span class="snapshot-label">Aftermath</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="report-details-section">
                            <h2>Detailed Analysis</h2>
                            <div class="details-grid">
                                <div class="detail-card">
                                    <div class="detail-icon">
                                        <i class="fas fa-car-crash"></i>
                                    </div>
                                    <div class="detail-content">
                                        <h3>Incident Details</h3>
                                        <ul class="detail-list">
                                            <li><strong>Incident Type:</strong> <span id="incidentType">Vehicle Collision</span></li>
                                            <li><strong>Vehicles Involved:</strong> <span id="vehiclesInvolved">2</span></li>
                                            <li><strong>Vehicle Types:</strong> <span id="vehicleTypes">Sedan, SUV</span></li>
                                            <li><strong>Estimated Speed:</strong> <span id="estimatedSpeed">45 km/h</span></li>
                                            <li><strong>Impact Severity:</strong> <span id="impactSeverity">High</span></li>
                                            <li><strong>Potential Injuries:</strong> <span id="potentialInjuries">Yes</span></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <div class="detail-icon">
                                        <i class="fas fa-map-marked-alt"></i>
                                    </div>
                                    <div class="detail-content">
                                        <h3>Location Information</h3>
                                        <div id="incidentMap" class="incident-map"></div>
                                        <ul class="detail-list">
                                            <li><strong>GPS Coordinates:</strong> <span id="gpsCoordinates">40.7128° N, 74.0060° W</span></li>
                                            <li><strong>Road Type:</strong> <span id="roadType">Intersection</span></li>
                                            <li><strong>Traffic Conditions:</strong> <span id="trafficConditions">Moderate</span></li>
                                            <li><strong>Weather Conditions:</strong> <span id="weatherConditions">Clear</span></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <div class="detail-icon">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="detail-content">
                                        <h3>AI Detection Metrics</h3>
                                        <div class="metrics-container">
                                            <div class="metric-item">
                                                <div class="metric-label">Overall Confidence</div>
                                                <div class="metric-gauge high">
                                                    <div class="gauge-value">98%</div>
                                                </div>
                                            </div>
                                            <div class="metric-item">
                                                <div class="metric-label">Vehicle Detection</div>
                                                <div class="metric-gauge high">
                                                    <div class="gauge-value">99%</div>
                                                </div>
                                            </div>
                                            <div class="metric-item">
                                                <div class="metric-label">Collision Detection</div>
                                                <div class="metric-gauge high">
                                                    <div class="gauge-value">97%</div>
                                                </div>
                                            </div>
                                            <div class="metric-item">
                                                <div class="metric-label">Injury Probability</div>
                                                <div class="metric-gauge medium">
                                                    <div class="gauge-value">75%</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="detection-chart-container">
                                            <canvas id="detectionChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="detail-card">
                                    <div class="detail-icon">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div class="detail-content">
                                        <h3>Response Actions</h3>
                                        <div class="action-timeline">
                                            <div class="action-item completed">
                                                <div class="action-time">17:23:05</div>
                                                <div class="action-content">
                                                    <div class="action-title">Incident Detected</div>
                                                    <div class="action-description">AI system detected the collision</div>
                                                </div>
                                            </div>
                                            <div class="action-item completed">
                                                <div class="action-time">17:23:08</div>
                                                <div class="action-content">
                                                    <div class="action-title">Analysis Completed</div>
                                                    <div class="action-description">AI analyzed severity and potential injuries</div>
                                                </div>
                                            </div>
                                            <div class="action-item completed">
                                                <div class="action-time">17:23:10</div>
                                                <div class="action-content">
                                                    <div class="action-title">Emergency Services Notified</div>
                                                    <div class="action-description">Automatic alert sent to emergency services</div>
                                                </div>
                                            </div>
                                            <div class="action-item completed">
                                                <div class="action-time">17:23:15</div>
                                                <div class="action-content">
                                                    <div class="action-title">Traffic Management Alerted</div>
                                                    <div class="action-description">Traffic management team notified</div>
                                                </div>
                                            </div>
                                            <div class="action-item in-progress">
                                                <div class="action-time">17:28:42</div>
                                                <div class="action-content">
                                                    <div class="action-title">Emergency Response</div>
                                                    <div class="action-description">Emergency services arrived at the scene</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="report-recommendations-section">
                            <h2>Recommendations</h2>
                            <div class="recommendations-list">
                                <div class="recommendation-item high">
                                    <div class="recommendation-icon">
                                        <i class="fas fa-ambulance"></i>
                                    </div>
                                    <div class="recommendation-content">
                                        <h3>Medical Response</h3>
                                        <p>Dispatch medical personnel to assess and treat potential injuries.</p>
                                    </div>
                                    <div class="recommendation-priority">
                                        <span>High Priority</span>
                                    </div>
                                </div>
                                <div class="recommendation-item high">
                                    <div class="recommendation-icon">
                                        <i class="fas fa-traffic-light"></i>
                                    </div>
                                    <div class="recommendation-content">
                                        <h3>Traffic Management</h3>
                                        <p>Deploy traffic management personnel to redirect traffic and prevent congestion.</p>
                                    </div>
                                    <div class="recommendation-priority">
                                        <span>High Priority</span>
                                    </div>
                                </div>
                                <div class="recommendation-item medium">
                                    <div class="recommendation-icon">
                                        <i class="fas fa-car"></i>
                                    </div>
                                    <div class="recommendation-content">
                                        <h3>Vehicle Recovery</h3>
                                        <p>Arrange for towing services to clear damaged vehicles from the roadway.</p>
                                    </div>
                                    <div class="recommendation-priority">
                                        <span>Medium Priority</span>
                                    </div>
                                </div>
                                <div class="recommendation-item low">
                                    <div class="recommendation-icon">
                                        <i class="fas fa-clipboard-list"></i>
                                    </div>
                                    <div class="recommendation-content">
                                        <h3>Incident Documentation</h3>
                                        <p>Document the incident details for insurance and legal purposes.</p>
                                    </div>
                                    <div class="recommendation-priority">
                                        <span>Low Priority</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="report-detail-sidebar">
                <div class="sidebar-card">
                    <h3>Report Information</h3>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">Report ID</span>
                            <span class="info-value" id="reportId">REP-2023-05142</span>
                        </li>
                        <li>
                            <span class="info-label">Generated</span>
                            <span class="info-value" id="reportGenerated">May 14, 2023 - 17:23:15</span>
                        </li>
                        <li>
                            <span class="info-label">Last Updated</span>
                            <span class="info-value" id="reportUpdated">May 14, 2023 - 17:45:22</span>
                        </li>
                        <li>
                            <span class="info-label">Status</span>
                            <span class="info-value status-active" id="reportStatus">Active</span>
                        </li>
                    </ul>
                </div>

                <div class="sidebar-card">
                    <h3>AI Confidence Score</h3>
                    <div class="confidence-score">
                        <div class="score-circle high">
                            <div class="score-value">98%</div>
                        </div>
                        <div class="score-label">Overall Confidence</div>
                    </div>
                    <div class="confidence-details">
                        <div class="confidence-item">
                            <div class="confidence-bar-label">
                                <span>Vehicle Detection</span>
                                <span>99%</span>
                            </div>
                            <div class="confidence-bar">
                                <div class="confidence-bar-fill high" style="width: 99%;"></div>
                            </div>
                        </div>
                        <div class="confidence-item">
                            <div class="confidence-bar-label">
                                <span>Collision Detection</span>
                                <span>97%</span>
                            </div>
                            <div class="confidence-bar">
                                <div class="confidence-bar-fill high" style="width: 97%;"></div>
                            </div>
                        </div>
                        <div class="confidence-item">
                            <div class="confidence-bar-label">
                                <span>Injury Assessment</span>
                                <span>75%</span>
                            </div>
                            <div class="confidence-bar">
                                <div class="confidence-bar-fill medium" style="width: 75%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-card">
                    <h3>Similar Incidents</h3>
                    <div class="similar-incidents">
                        <div class="similar-incident">
                            <div class="incident-meta">
                                <span class="incident-type accident">Accident</span>
                                <span class="incident-date">May 10, 2023</span>
                            </div>
                            <div class="incident-title">Vehicle Collision at East Sector, Junction 10</div>
                            <a href="#" class="incident-link">View Report</a>
                        </div>
                        <div class="similar-incident">
                            <div class="incident-meta">
                                <span class="incident-type accident">Accident</span>
                                <span class="incident-date">April 28, 2023</span>
                            </div>
                            <div class="incident-title">Multi-vehicle Collision on Highway 42</div>
                            <a href="#" class="incident-link">View Report</a>
                        </div>
                        <div class="similar-incident">
                            <div class="incident-meta">
                                <span class="incident-type accident">Accident</span>
                                <span class="incident-date">April 15, 2023</span>
                            </div>
                            <div class="incident-title">Vehicle Collision at North Sector, Main Street</div>
                            <a href="#" class="incident-link">View Report</a>
                        </div>
                    </div>
                </div>

                <div class="sidebar-card">
                    <h3>Historical Data</h3>
                    <div class="historical-data">
                        <div class="historical-chart-container">
                            <canvas id="historicalChart"></canvas>
                        </div>
                        <div class="historical-stats">
                            <div class="stat-item">
                                <div class="stat-value">24</div>
                                <div class="stat-label">Incidents at this location</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">+15%</div>
                                <div class="stat-label">Increase from last month</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Share Report Modal -->
    <div class="modal" id="shareReportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Share Report</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="share-options">
                    <div class="share-option">
                        <label for="shareEmail">Email</label>
                        <div class="input-with-button">
                            <input type="email" id="shareEmail" placeholder="Enter email address">
                            <button class="btn-primary">Send</button>
                        </div>
                    </div>
                    <div class="share-option">
                        <label>Share Link</label>
                        <div class="input-with-button">
                            <input type="text" id="shareLink" value="https://alertx.com/reports/REP-2023-05142" readonly>
                            <button class="btn-outline copy-link">Copy</button>
                        </div>
                    </div>
                    <div class="share-option">
                        <label>Share with Team</label>
                        <div class="team-members">
                            <div class="team-member">
                                <img src="https://via.placeholder.com/40" alt="Team Member">
                                <span>John Doe</span>
                                <input type="checkbox">
                            </div>
                            <div class="team-member">
                                <img src="https://via.placeholder.com/40" alt="Team Member">
                                <span>Jane Smith</span>
                                <input type="checkbox">
                            </div>
                            <div class="team-member">
                                <img src="https://via.placeholder.com/40" alt="Team Member">
                                <span>Mike Johnson</span>
                                <input type="checkbox">
                            </div>
                        </div>
                        <button class="btn-primary">Share with Selected</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Report Modal -->
    <div class="modal" id="exportReportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Export Report</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <div class="export-option">
                        <input type="radio" id="exportPDF" name="exportFormat" value="pdf" checked>
                        <label for="exportPDF">
                            <i class="fas fa-file-pdf"></i>
                            <div>
                                <h4>PDF Document</h4>
                                <p>Complete report with all details and visualizations</p>
                            </div>
                        </label>
                    </div>
                    <div class="export-option">
                        <input type="radio" id="exportCSV" name="exportFormat" value="csv">
                        <label for="exportCSV">
                            <i class="fas fa-file-csv"></i>
                            <div>
                                <h4>CSV Spreadsheet</h4>
                                <p>Raw data in spreadsheet format</p>
                            </div>
                        </label>
                    </div>
                    <div class="export-option">
                        <input type="radio" id="exportJSON" name="exportFormat" value="json">
                        <label for="exportJSON">
                            <i class="fas fa-file-code"></i>
                            <div>
                                <h4>JSON Data</h4>
                                <p>Structured data for developers</p>
                            </div>
                        </label>
                    </div>
                </div>
                <div class="export-options-additional">
                    <h4>Include in Export</h4>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" checked> Report Summary
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked> Detailed Analysis
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked> Visual Data
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked> Video Snapshots
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" checked> AI Confidence Scores
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn-outline">Cancel</button>
                    <button class="btn-primary">Export Report</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.38.4/dist/umd/supabase.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="report-detail.js"></script>
</body>
</html>